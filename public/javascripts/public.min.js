function returnReferrer(a){var b=a.toString().split("?");if(b.length>=2){var c=b[1].split("&");if(c.length>0){for(var d=new Object,e=0;e<c.length;e++)d[c[e].split("=")[0]]=c[e].split("=")[1];return void 0!=d.poll?d.poll.replace(/[^A-Za-z0-9]/g,""):a}return a}return a}function setLocalStorageData(a){if("undefined"!=typeof Storage){var b=returnReferrer(window.location.href);localStorage.setItem(b,a)}}function checkLocalStorageData(){if("undefined"!=typeof Storage){var a=returnReferrer(window.location.href),b=localStorage.getItem(a);return null!=b&&0!=b.length&&0!=$(".easypoll-form").length&&b}return!1}function drawChart(){var a=google.visualization.arrayToDataTable(chartData),b=new google.visualization.DataView(a);b.setColumns([0,1,2,3]);var c={title:"",width:chartWidth,height:chartHeight,bar:{groupWidth:"95%"},legend:{position:"none"}};if(0!=$("#easypoll-chart").length){new google.visualization.BarChart(document.getElementById("easypoll-chart")).draw(b,c)}}function drawBarChart(a,b,c){google.charts.load("current",{packages:["corechart"]});var d=String(a).split(","),e=String(c).split(",");if(d.length>0){chartData=[[languageArray[1],languageArray[2],{role:"style"},{role:"annotation"}]];for(var f=d.length-1;f>=0;f--){var g=.5,h="";f<5&&(g=1-f/10),""!=d[f]?(h=String((100*Number(d[f])/b).toFixed(0))+"%",chartData[chartData.length]=[String(e[f]),Number(d[f]),"color:"+colorsArray[0]+"; stroke-color: white; fill-opacity:"+g,h]):chartData[chartData.length]=[String(e[f]),0,"color:"+colorsArray[0]+"; stroke-color: white; fill-opacity:"+g,h]}google.charts.setOnLoadCallback(drawChart)}}function drawPreviousResponse(a,b){if(0!=$(b).length&&void 0!=$(b).attr("data-labels")&&void 0!=$(b).attr("data-polltype")){$(b).css("display","none");var c="",d=$(b).attr("data-labels").split(",");if("0"==$(b).attr("data-polltype"))for(var e=0;e<d.length;e++)c+=a>=e+1?'<div class="easypoll-radio radio-inline-true"></div>':'<div class="easypoll-radio radio-inline-false"></div>';$(b).after('<div class="easypoll-previous-results"><div class="alert alert-success">'+languageArray[0]+": "+d[a-1]+"</div>"+c+"</div>")}}var languageArray=["Your rating","Rating","Number of ratings","Completed"],colorsArray=["#ffcc33"],chartData=[],chartWidth=400,chartHeight=125;$(document).ready(function(){var a=checkLocalStorageData(),b=!1,c=languageArray[3];0==a?(void 0!==$("#ratings-form-submit")&&void 0!==$("#ratings-form")&&($("#ratings-form-submit").css("display","block"),$("#ratings-form").css("display","block")),void 0!==$("#ratings-form")&&$("#ratings-form").submit(function(a){0==b&&setLocalStorageData(c)}),$(".easypoll-form").find(".radio").click(function(a){void 0!==$("input[name=rating]:checked").val()&&(b=!0,c=String($("input[name=rating]:checked").val()),setLocalStorageData(c),void 0!==$("#ratings-form-submit")&&$("#ratings-form-submit").attr("disabled",!1),void 0!==$("#ratings-form")&&$("#ratings-form").submit())})):0==isNaN(a)&&drawPreviousResponse(Number(a),$(".easypoll-form")),0!=$("#easypoll-chart").length&&void 0!=$("#easypoll-chart").attr("data-ratings")&&void 0!=$("#easypoll-chart").attr("data-total")&&void 0!=$("#easypoll-chart").attr("data-labels")&&drawBarChart($("#easypoll-chart").attr("data-ratings"),$("#easypoll-chart").attr("data-total"),$("#easypoll-chart").attr("data-labels"))});